parameters:
 disk_size: 80
 numcpus: 8
 memory: 16384
 pool: default
 image: centos8
 minikube: true
 virtual_masters_disks_size: 120
 network: default
 notify: true
 cluster: testk
 start: false
 virtual_masters: true
 virtual_masters_number: 3
 virtual_masters_numcpus: 8
 virtual_masters_memory: 16384
 deploy: false

{{ image }}:
  type: image

{% if virtual_masters %}
{%- for num in range(0, virtual_masters_number) %}
{{ cluster }}-master-{{ num }}:
 pool: {{ pool }}
 numcpus: {{ virtual_masters_numcpus }}
 start: {{ start }}
 iso: {{ cluster}}.iso
 memory: {{ virtual_masters_memory }}
 nets:
  - name: {{ network }}
 disks:
  - size: {{ virtual_masters_disks_size }}
    interface: scsi
{%- endfor %}
{%- endif %}

{{ cluster }}-installer:
 image: {{ image }}
 memory: {{ memory }}
 numcpus: {{ numcpus }}
 disks: [{{ disk_size }}]
 nets: [{{ network }}]
 scripts:
 - pre.sh
{% if minikube %}
 - minikube.sh
{% endif %}
 - installer.sh
{% if deploy %}
 - deploy.sh
{% endif %}
 notify: {{ notify }}
 notifyscript: notify.sh

